<div class="invoice-detail-container">
  <div class="invoice-header">
    <div class="invoice-info">
      <div class="date-section">
        <label>Дата на издаване:</label>
        <div class="date-value">{{ invoice?.issueDate | dateFormat }}</div>
      </div>
      
      <div class="invoice-number-section">
        <div class="invoice-number">Фактура №{{ getFormattedInvoiceNumber() }}</div>
      </div>

      <div class="invoice-location-section">
        <label>Място на издаване:</label>
        <div class="invoice-location">{{ invoice?.issueLocation }}</div>
      </div>
    </div>
  </div>

  <div class="invoice-content">
    <div class="recipient-section">
      <h3>ПОЛУЧАТЕЛ</h3>
      <div class="company-details">
        <div class="company-name">{{ invoice?.client?.name }}</div>
        <div class="detail-row">
          <span class="label">ЕИК:</span>
          <span class="value">{{ invoice?.client?.identityNumber }}</span>
        </div>
        <div class="detail-row">
          <span class="label">ЕИК по ЗДДС:</span>
          <span class="value">{{ invoice?.client?.vatNumber }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Адрес:</span>
          <span class="value">{{ invoice?.client?.address }}</span>
        </div>
        <div class="detail-row">
          <span class="label">МОЛ:</span>
          <span class="value">{{ invoice?.client?.responsibleOfficerName }}</span>
        </div>
      </div>
    </div>

    <div class="supplier-section">
      <h3>ДОСТАВЧИК</h3>
      <div class="company-details">
        <div class="company-name">{{ invoice?.provider?.name }}</div>
        <div class="detail-row">
          <span class="label">ЕИК:</span>
          <span class="value">{{ invoice?.provider?.identityNumber }}</span>
        </div>
        <div class="detail-row">
          <span class="label">ЕИК по ЗДДС:</span>
          <span class="value">{{ invoice?.provider?.vatNumber }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Адрес:</span>
          <span class="value">{{ invoice?.provider?.address }}</span>
        </div>
        <div class="detail-row">
          <span class="label">МОЛ:</span>
          <span class="value">{{ invoice?.provider?.responsibleOfficerName }}</span>
        </div>
        <div class="detail-row">
          <span class="label">BIC/Банка:</span>
          <span class="value">{{ invoice?.provider?.bankIdentifierCode }}/{{ invoice?.provider?.bankName }}</span>
        </div>
        <div class="detail-row">
          <span class="label">IBAN:</span>
          <span class="value">{{ invoice?.provider?.iban }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Invoice Items Table -->
  <div class="invoice-items-section">
    <div class="items-table-container">
      <table class="items-table">
        <thead>
          <tr>
            <th class="col-number">№</th>
            <th class="col-description">Описание</th>
            <th class="col-quantity">Количество</th>
            <th class="col-unit-price">Ед. цена</th>
            <th class="col-discount">Отстъпка</th>
            <th class="col-total">Стойност</th>
          </tr>
        </thead>
        <tbody>
          @for (item of invoice?.contents; track $index; let i = $index) {
            <tr>
              <td class="col-number">{{ i + 1 }}</td>
              <td class="col-description">{{ item.serviceDescription }}</td>
              <td class="col-quantity">{{ item.quantity }}</td>
              <td class="col-unit-price">{{ item.unitPrice | number:'1.2-2' }}</td>
              <td class="col-discount">{{ item.discount | number:'1.2-2' }}%</td>
              <td class="col-total">{{ item.totalPriceInBulgarianLev | number:'1.2-2' }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  <!-- Financial Summary Section -->
  <div class="financial-summary-section">
    <div class="verbal-total">
      <div class="verbal-total-label">Словом в лева:</div>
      <div class="verbal-total-value">{{ invoice?.verbalTotalPriceWithVatInBulgarianLev || 'Не е посочена' }}</div>
      <div class="verbal-total-label">Словом в евро:</div>
      <div class="verbal-total-value">{{ invoice?.verbalTotalPriceWithVatInEuro || 'Не е посочена' }}</div>
    </div>
    
    <div class="financial-calculations">
      <div class="calculation-row">
        <span class="calculation-label">Данъчна основа:</span>
        <span class="calculation-value">{{ getTaxableBase() | number:'1.2-2' }}</span>
      </div>
      <div class="calculation-row">
        <span class="calculation-label">Ставка ДДС:</span>
        <span class="calculation-value">20%</span>
      </div>
      <div class="calculation-row">
        <span class="calculation-label">ДДС:</span>
        <span class="calculation-value">{{ getVAT() | number:'1.2-2' }}</span>
      </div>
        <div class="calculation-row">
          <span class="calculation-label">Сума за плащане в лева:</span>
          <span class="calculation-value">{{ getTotalAmountInBulgarianLev() | number:'1.2-2' }}</span>
        </div>
        <div class="calculation-row">
          <span class="calculation-label">Сума за плащане в евро:</span>
          <span class="calculation-value">{{ getTotalAmountInEuro() | number:'1.2-2' }}</span>
        </div>
    </div>
  </div>

  <div class="invoice-actions">
    <button class="back-button" (click)="goBack()">Назад</button>
    <button class="print-button" (click)="printInvoice()">Печат</button>
  </div>
</div>
